<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="parking">
	<typeAlias alias="parking" type="co.kr.parkprice.model.Parking" />

	<select id="getParking" resultClass="parking">
		SELECT   p_idx
				,p_type
				,p_name
				,p_latitude
				,p_longitude
				,p_address
				,p_time
				,p_pricetable
				,p_price1
				,p_per1
				,p_price2
				,p_per2
				,p_etc
				,p_state
				,p_lastupdate
				,p_registdate
				,p_comment
				,p_commentId
				,p_image1
				,p_image2
				,p_image3
				,p_count
				,(select count(*) from pk_parking) as totalCnt
		  FROM pk_parking
		 WHERE 1=1
	  	  <isNotEmpty property="p_idx">
		   AND p_idx = #p_idx# 
		  </isNotEmpty> 
	  ORDER BY p_idx DESC 
		  <isEmpty property="p_idx">
		 	LIMIT #pageNo# , 20 
		  </isEmpty>
	</select>
	
	<insert id="insertParking">
		INSERT INTO pk_parking
		(
		 p_idx
		,p_type
		,p_name
		,p_latitude
		,p_longitude
		,p_address
		,p_time
		,p_pricetable
		,p_price1
		,p_per1
		,p_price2
		,p_per2
		,p_etc
		,p_state
		,p_lastupdate
		,p_registdate
		,p_comment
		,p_commentId
		,p_image1
		,p_image2
		,p_image3
		,p_count
		)
		VALUES(
		 #p_idx#
		,#p_type#
		,#p_name#
		,#p_latitude#
		,#p_longitude#
		,#p_address#
		,#p_time#
		,#p_pricetable#
		,#p_price1#
		,#p_per1#
		,#p_price2#
		,#p_per2#
		,#p_etc#
		,#p_state#
		,#p_lastupdate#
		,#p_registdate#
		,#p_comment#
		,#p_commentId#
		,#p_image1#
		,#p_image2#
		,#p_image3#
		,#p_count#
		)
	</insert>
	
	<delete id="deleteParking">
		DELETE FROM pk_parking WHERE p_idx = #p_idx#
	</delete>
	
	<update id="updateParking">
		UPDATE pk_parking
	       SET 
	           <isNotEmpty property="p_type">
	           p_type = #p_type#
	           </isNotEmpty>
	           <isNotEmpty property="p_name">
	           p_name = #p_name#
	           </isNotEmpty>
	           <isNotEmpty property="p_latitude">
	           p_latitude = #p_latitude#
	           </isNotEmpty>
	           <isNotEmpty property="p_longitude">
	           p_longitude = #p_longitude#
	           </isNotEmpty>
	           <isNotEmpty property="p_address">
	           p_address = #p_address#
	           </isNotEmpty>
	           <isNotEmpty property="p_time">
	           p_time = #p_time#
	           </isNotEmpty>
	           <isNotEmpty property="p_pricetable">
	           p_pricetable = #p_pricetable#
	           </isNotEmpty>
	           <isNotEmpty property="p_per1">
	           p_per1 = #p_per1#
	           </isNotEmpty>
	           <isNotEmpty property="p_price1">
	           p_price1 = #p_price1#
	           </isNotEmpty>
	           <isNotEmpty property="p_per2">
	           p_per2 = #p_per2#
	           </isNotEmpty>
	           <isNotEmpty property="p_price2">
	           p_price2 = #p_price2#
	           </isNotEmpty>
	           <isNotEmpty property="p_etc">
	           p_etc = #p_etc#
	           </isNotEmpty>
	           <isNotEmpty property="p_state">
	           p_state = #p_state#
	           </isNotEmpty>
	    WHERE p_idx = #p_idx#
	</update>
	 
</sqlMap>